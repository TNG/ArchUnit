plugins {
    id 'com.github.spotbugs'
    id 'com.diffplug.spotless'
    id 'org.openrewrite.rewrite'
}
dependencies {
    rewrite('org.openrewrite.recipe:rewrite-java-security:3.22.0')
    rewrite('org.openrewrite.recipe:rewrite-migrate-java:3.22.0')
    rewrite('org.openrewrite.recipe:rewrite-rewrite:0.16.0')
    rewrite('org.openrewrite.recipe:rewrite-static-analysis:2.22.0')
    rewrite('org.openrewrite.recipe:rewrite-testing-frameworks:3.22.0')
    rewrite('org.openrewrite.recipe:rewrite-third-party:0.31.2')
}
rewrite {
    activeRecipe('com.tngtech.archunit.openrewrite.SanityCheck')
    configFile = project.getRootProject().file('buildSrc/src/main/resources/code_quality/rewrite.yml')
    exclusions.addAll(
            '**special-tests.gradle',
            '**testlib/src/main/resources**'
    )
    exportDatatables = true
    failOnDryRunResults = true
}
spotbugs {
    excludeFilter = rootProject.file('buildSrc/src/main/resources/code_quality/spotbugs-excludes.xml')
}
spotbugsMain {
    reports {
        xml.enabled false
        html.enabled true
    }
}
spotbugsTest.enabled = false
spotless {
    java {
        // palantirJavaFormat() // might consider.
        forbidWildcardImports()
        removeUnusedImports()
        trimTrailingWhitespace()
    }
}
