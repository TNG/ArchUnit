<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <title>Visualization</title>
  <link rel='stylesheet' href='styles.css'>
  <link id='visualization-styles' rel='stylesheet' href='visualizationstyles.css'>

  <script src='webcomponents-loader.js'></script>
  <script src='visualization-bundle.js'></script>

  <link rel='import' href='menu.html'>
  <link rel='import' href='violation-menu.html'>
</head>
<body>

<visualization-menu id='menu'></visualization-menu>

<div class="horizontal-container">
  <div id='container'>
    <svg id='visualization'>
      <defs>
        <marker id="end_arrow" viewBox="0 -5 10 10" refX="10" markerUnits="userSpaceOnUse" markerWidth="10" markerHeight="10" orient="auto">
          <path d="M0,-5L10,0L0,5"></path>
        </marker>
      </defs>
    </svg>
  </div>

  <div id="violations-container">
    <!--TODO: add label with 'show violations:'-->
    <violation-menu id='violations'></violation-menu>
  </div>
</div>

<!-- We use this svg to calculate text widths of rendered texts, see calculateTextWidth()-function -->
<svg id='text-size-computation' class='node' style='display: none;'>
  <text></text>
</svg>

<script>
  const visualization = require('visualization');

  const webComponentsInitialized = new Promise(resolve => {
    window.addEventListener('WebComponentsReady', function () {
      resolve();
    });
  });

  Promise.all([
    visualization.createGraph(),
    webComponentsInitialized
  ]).then(results => {
    const graph = results[0];
    graph.attachToMenu(document.querySelector('#menu'));
    graph.attachToViolationMenu(document.querySelector('#violations'));
    document.body.onresize = graph.render;
  });
</script>
</body>
</html>